NOTE
#------------
#DISK PARTITIONING  <<GPT>>
NAME                MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
sda                   8:0    0 465.8G  0 disk  
|-sda1                8:1    0   512M  0 part  /boot/efi
|-sda2                8:2    0   514M  0 part  
| `-encrypted-boot  253:5    0   512M  0 crypt /boot
`-sda3                8:3    0 464.8G  0 part  
  `-root            253:2    0 464.8G  0 crypt 
    |-notebook-root 253:3    0   100G  0 lvm   /
    `-notebook-home 253:4    0   200G  0 lvm   /home

#FSTAB --> directories stored in memory
UUID=586fbba9-d38d-43c1-9e8b-b780a9d7a76d   /          ext4     rw,relatime,data=ordered 0 1
UUID=d8546367-f2ee-46a4-b587-b926703bfdb1   /home      ext4     rw,relatime,data=ordered 0 0
UUID=4fa59ac1-df34-45d1-b91a-2f37ca0c2f6b   /boot      ext4     noauto,rw,relatime,data=ordered 0 0
UUID=2E77-3F97                              /boot/efi  ext4     noauto,rw,relatime,data=ordered 0 0

# tmps
tmpfs            /tmp               tmpfs    size=4G                               0 0
tmpfs            /run               tmpfs    size=100M                             0 0
tmpfs            /var/tmp           tmpfs    rw,nosuid,noatime,nodev,size=4G,mode=1777  0 0
tmpfs            /var/tmp/portage   tmpfs    rw,nosuid,noatime,nodev,size=4G,mode=755,uid=portage,gid=portage,x-mount.mkdir=755  0 0
# shm
shm              /dev/shm           tmpfs    nodev,nosuid,noexec                   0 0
proc             /proc              proc     rw,nosuid,nodev,noexec,relatime       0 0
#------------
#LUKS - KERNEL 
[*] Enable loadable module support
Device Drivers --->
    [*] Multiple devices driver support (RAID and LVM) --->
        <*> Device mapper support
        <*> Crypt target support
[*] Cryptographic API --->
    <*> XTS support
    <*> SHA224 and SHA256 digest algorithm
    <*> AES cipher algorithms
    <*> AES cipher algorithms (x86_64)
    <*> User-space interface for symmetric key cipher algorithms
General setup  --->
    [*] Initial RAM filesystem and RAM disk (initramfs/initrd) support
#COMM
cryptsetup --verbose --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 5000 --use-random luksFormat /dev/sda2
#CREATE KEY
dd bs=512 count=4 if=/dev/urandom of=/boot/overlay/mnt/key/root_luks.key
cryptsetup luksAddKey /dev/sda1 /boot/overlay/mnt/key/root_luks.key
#------------
#DURING INSTALLATION
mount /dev/sda2 /mnt/gentoo/boot/
mount --bind /dev/ /mnt/gentoo/dev/
mount --bind /sys/ /mnt/gentoo/sys/
mount --bind /run/ /mnt/gentoo/run/
mount -t proc none /mnt/gentoo/proc/
#------------
#GRUB !!!
cat >/etc/default/grub << EOF
GRUB_DISTRIBUTOR="corebook"
GRUB_TIMEOUT=5
GRUB_CMDLINE_LINUX="udev dolvm crypt_root=UUID=e6c28daf-feee-4258-b6a8-c013887a4d9c real_root=UUID=fe878eb4-f4ca-4400-af73-1b0ff0bd0312 crypt_device=UUID=e6c28daf-feee-4258-b6a8-c013887a4d9c:encrypted-lvm root_key=root_luks.key root_trim=yes"
GRUB_ENABLE_CRYPTODISK=y    #for encrypted boot
GRUB_TERMINAL=console
GRUB_DISABLE_SUBMENU=y
EOF

#COMM
grub-install /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg
mkdir -p /boot/overlay/mnt/key/  "root_luks.key"   #for insert luks key in initramfs
#------------
#GENKERNEL
cat > /etc/genkernel.conf << EOF
OLDCONFIG="yes"
MENUCONFIG="no"
CLEAN="yes"
MRPROPER="no"
MOUNTBOOT="yes"
SAVE_CONFIG="yes"
USECOLOR="yes"
LVM="yes"
LUKS="yes"
DISKLABEL="yes"
GK_SHARE="${GK_SHARE:-/usr/share/genkernel}"
CACHE_DIR="/var/cache/genkernel"
DISTDIR="${GK_SHARE}/distfiles"
LOGFILE="/var/log/genkernel.log"
LOGLEVEL=1
DEFAULT_KERNEL_SOURCE="/usr/src/linux"
INITRAMFS_OVERLAY="/boot/overlay"         #for insert luks key in initramfs
REAL_ROOT="/dev/mapper/notebook-root"
EOF
#COMM
genkernel --luks --lvm initramfs
#------------
#LVM
cat > /etc/lvm/lvm.conf << EOF
issue_discards = 1
EOF
#------------
#ADD USER
useradd -s /bin/bash -m -G wheel,video corealugly




#PROGRAMM LIST
#OTHER
sys-process/glances 
net-analyzer/arp-scan
x11-misc/read-edid
x11-misc/compton
#------------
# X PROGRAMMS
x11-misc/compton
x11-wm/awesome-4.2
x11-plugins/vicious
x11-base/xorg-server
x11-misc/slim
x11-app/xrandr
#------------
# SYSTEM PROGRAMMS
app-portage/gentoolkit
app-portage/eix
sys-apps/mlocate
#------------
#INSTALL XFCE4
emerge -av xfce4-meta xfce4-notifyd
emerge --deselect xfce4-notifyd
emerge -av xfce4-terminal
emerge -av xfce-extra/xfce4-volumed-pulse
emerge -av gtk-engines-xfce x11-themes/greybird
emerge -av xfce-extra/thunar-volman xfce-extra/thunar-vcs-plugin  xfce-extra/thunar-media-tags-plugin xfce-extra/thunar-archive-plugin xfce-base/thunar
emerge -av x11-misc/slim
#------------
perl-cleaner -allmodules
python-updater

